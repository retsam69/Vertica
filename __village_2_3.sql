DROP TABLE st4hdc.VILLAGE;

CREATE TABLE st4hdc.VILLAGE
(
    HOSPCODE varchar(5) NOT NULL,
    VID varchar(8) NOT NULL,
    NTRADITIONAL numeric(4,0),
    NMONK numeric(4,0),
    NRELIGIONLEADER numeric(4,0),
    NBROADCAST numeric(2,0),
    NRADIO numeric(2,0),
    NPCHC numeric(2,0),
    NCLINIC numeric(3,0),
    NDRUGSTORE numeric(3,0),
    NCHILDCENTER numeric(3,0),
    NPSCHOOL numeric(2,0),
    NSSCHOOL numeric(2,0),
    NTEMPLE numeric(2,0),
    NRELIGIOUSPLACE numeric(2,0),
    NMARKET numeric(2,0),
    NSHOP numeric(3,0),
    NFOODSHOP numeric(3,0),
    NSTALL numeric(3,0),
    NRAINTANK numeric(3,0),
    NCHICKENFARM numeric(3,0),
    NPIGFARM numeric(3,0),
    WASTEWATER char(1),
    GARBAGE char(1),
    NFACTORY numeric(3,0),
    LATITUDE numeric(10,6),
    LONGITUDE numeric(10,6),
    OUTDATE date,
    NUMACTUALLY numeric(2,0),
    RISKTYPE numeric(3,0),
    NUMSTATELESS numeric(3,0),
    NEXERCISECLUB numeric(3,0),
    NOLDERLYCLUB numeric(3,0),
    NDISABLECLUB numeric(3,0),
    NNUMBERONECLUB numeric(3,0),
    D_UPDATE timestamp NOT NULL,
    HDC_DATE timestamp,
    SOURCE_DATA varchar(6)
);

ALTER TABLE st4hdc.VILLAGE ADD CONSTRAINT VILLAGE_PK PRIMARY KEY (HOSPCODE, VID) ENABLED;


CREATE PROJECTION st4hdc.VILLAGE /*+createtype(A)*/ 
(
 HOSPCODE,
 VID,
 NTRADITIONAL,
 NMONK,
 NRELIGIONLEADER,
 NBROADCAST,
 NRADIO,
 NPCHC,
 NCLINIC,
 NDRUGSTORE,
 NCHILDCENTER,
 NPSCHOOL,
 NSSCHOOL,
 NTEMPLE,
 NRELIGIOUSPLACE,
 NMARKET,
 NSHOP,
 NFOODSHOP,
 NSTALL,
 NRAINTANK,
 NCHICKENFARM,
 NPIGFARM,
 WASTEWATER,
 GARBAGE,
 NFACTORY,
 LATITUDE,
 LONGITUDE,
 OUTDATE,
 NUMACTUALLY,
 RISKTYPE,
 NUMSTATELESS,
 NEXERCISECLUB,
 NOLDERLYCLUB,
 NDISABLECLUB,
 NNUMBERONECLUB,
 D_UPDATE,
 HDC_DATE,
 SOURCE_DATA
)
AS
 SELECT VILLAGE.HOSPCODE,
        VILLAGE.VID,
        VILLAGE.NTRADITIONAL,
        VILLAGE.NMONK,
        VILLAGE.NRELIGIONLEADER,
        VILLAGE.NBROADCAST,
        VILLAGE.NRADIO,
        VILLAGE.NPCHC,
        VILLAGE.NCLINIC,
        VILLAGE.NDRUGSTORE,
        VILLAGE.NCHILDCENTER,
        VILLAGE.NPSCHOOL,
        VILLAGE.NSSCHOOL,
        VILLAGE.NTEMPLE,
        VILLAGE.NRELIGIOUSPLACE,
        VILLAGE.NMARKET,
        VILLAGE.NSHOP,
        VILLAGE.NFOODSHOP,
        VILLAGE.NSTALL,
        VILLAGE.NRAINTANK,
        VILLAGE.NCHICKENFARM,
        VILLAGE.NPIGFARM,
        VILLAGE.WASTEWATER,
        VILLAGE.GARBAGE,
        VILLAGE.NFACTORY,
        VILLAGE.LATITUDE,
        VILLAGE.LONGITUDE,
        VILLAGE.OUTDATE,
        VILLAGE.NUMACTUALLY,
        VILLAGE.RISKTYPE,
        VILLAGE.NUMSTATELESS,
        VILLAGE.NEXERCISECLUB,
        VILLAGE.NOLDERLYCLUB,
        VILLAGE.NDISABLECLUB,
        VILLAGE.NNUMBERONECLUB,
        VILLAGE.D_UPDATE,
        VILLAGE.HDC_DATE,
        VILLAGE.SOURCE_DATA
 FROM st4hdc.VILLAGE
 ORDER BY VILLAGE.HOSPCODE,
          VILLAGE.VID
SEGMENTED BY hash(VILLAGE.HOSPCODE, VILLAGE.VID) ALL NODES KSAFE 1;

--SELECT MARK_DESIGN_KSAFE(1);
