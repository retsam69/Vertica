DROP TABLE st4hdc.PERSON;

CREATE TABLE st4hdc.PERSON
(
    HOSPCODE varchar(5) NOT NULL,
    CID varchar(13),
    PID varchar(15) NOT NULL,
    HID varchar(14),
    PRENAME varchar(3) NOT NULL,
    NAME varchar(50) NOT NULL,
    LNAME varchar(50) NOT NULL,
    HN varchar(15),
    SEX varchar(1) NOT NULL,
    BIRTH date NOT NULL,
    MSTATUS char(1),
    OCCUPATION_OLD varchar(3),
    OCCUPATION_NEW varchar(4),
    RACE varchar(3),
    NATION varchar(3) NOT NULL,
    RELIGION varchar(2),
    EDUCATION varchar(2),
    FSTATUS varchar(1),
    FATHER varchar(13),
    MOTHER varchar(13),
    COUPLE varchar(13),
    VSTATUS varchar(1),
    MOVEIN date,
    DISCHARGE varchar(1),
    DDISCHARGE date,
    ABOGROUP varchar(1),
    RHGROUP varchar(1),
    LABOR varchar(2),
    PASSPORT varchar(8),
    TYPEAREA varchar(1) NOT NULL,
    D_UPDATE timestamp,
 	TELEPHONE varchar(15),
	MOBILE varchar(15),    
    HDC_DATE timestamp,
    SOURCE_DATA varchar(6)
);

ALTER TABLE st4hdc.PERSON ADD CONSTRAINT PERSON_PK PRIMARY KEY (HOSPCODE, PID) ENABLED;

CREATE PROJECTION st4hdc.PERSON /*+createtype(A)*/ 
(
 HOSPCODE,
 CID,
 PID,
 HID,
 PRENAME,
 NAME,
 LNAME,
 HN,
 SEX,
 BIRTH,
 MSTATUS,
 OCCUPATION_OLD,
 OCCUPATION_NEW,
 RACE,
 NATION,
 RELIGION,
 EDUCATION,
 FSTATUS,
 FATHER,
 MOTHER,
 COUPLE,
 VSTATUS,
 MOVEIN,
 DISCHARGE,
 DDISCHARGE,
 ABOGROUP,
 RHGROUP,
 LABOR,
 PASSPORT,
 TYPEAREA,
 D_UPDATE,
 TELEPHONE,
 MOBILE,
 HDC_DATE,
 SOURCE_DATA
)
AS
 SELECT PERSON.HOSPCODE,
        PERSON.CID,
        PERSON.PID,
        PERSON.HID,
        PERSON.PRENAME,
        PERSON.NAME,
        PERSON.LNAME,
        PERSON.HN,
        PERSON.SEX,
        PERSON.BIRTH,
        PERSON.MSTATUS,
        PERSON.OCCUPATION_OLD,
        PERSON.OCCUPATION_NEW,
        PERSON.RACE,
        PERSON.NATION,
        PERSON.RELIGION,
        PERSON.EDUCATION,
        PERSON.FSTATUS,
        PERSON.FATHER,
        PERSON.MOTHER,
        PERSON.COUPLE,
        PERSON.VSTATUS,
        PERSON.MOVEIN,
        PERSON.DISCHARGE,
        PERSON.DDISCHARGE,
        PERSON.ABOGROUP,
        PERSON.RHGROUP,
        PERSON.LABOR,
        PERSON.PASSPORT,
        PERSON.TYPEAREA,
        PERSON.D_UPDATE,
        PERSON.TELEPHONE,
        PERSON.MOBILE,
        PERSON.HDC_DATE,
        PERSON.SOURCE_DATA
 FROM st4hdc.PERSON
 ORDER BY PERSON.HOSPCODE,
          PERSON.PID
SEGMENTED BY hash(PERSON.HOSPCODE, PERSON.PID) ALL NODES KSAFE 1;

--SELECT MARK_DESIGN_KSAFE(1);
